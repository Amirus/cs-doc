<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta name="generator" content="Muse">
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" charset="utf-8" media="all"
          href="../main.css" >
    <link rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon">
    <script type="text/javascript" charset="utf-8" src="../main.js"></script>
    <title>正交化与最小二乘法 - maTH&mu; - 计算机代数系统</title>
  </head>
  <body>
<div id="banner"></div><!-- banner -->    
<div id="header">
    <h1>正交化与最小二乘法
  </h1>
  <a name="top"></a>
  <div id="tab">
  <ul>
    <li><a href="../index.html" title="主页"><span>主页</span></a></li>
    <li><a href="../Doc.html" title="文档"><span>文档</span></a></li>
    <li><a href="../Dev.html" title="开发"><span>开发</span></a></li>
    <li><a href="http://groups.google.com/group/maTHmU?hl=zh-CN" title="论坛"><span>论坛</span></a></li>
    <li><a href="../JoinUs.html" title="加入我们"><span>加入我们</span></a></li>
  </ul>
  </div><!-- tab -->
</div><!-- header -->
<div id="container">
  <div id="body">
    <div id="leftshadow">
      <div id="page"> 
 <!-- Page published by Emacs Muse begins here -->
<a href="QRLS.html#" onClick="ShowHide(content)">隐藏目录</a>
<div id="content" class="contents">
<dl>
  <dt>
    <a href="QRLS.html#sec1">Householder反射</a>
  </dt>
  <dt>
    <a href="QRLS.html#sec2">Jacobi-Givens旋转</a>
  </dt>
  <dt>
    <a href="QRLS.html#sec3"><img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="QRLS.html#sec4">Householder <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec5">Givens <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">方法</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec6">Gram-Schmidt方法</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="QRLS.html#sec7">满秩的最小二乘问题</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="QRLS.html#sec8">法方程组方法</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec9">用<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解求解LS问题</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="QRLS.html#sec10">病态矩阵的正交分解</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="QRLS.html#sec11">选主列的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec12">完全正交分解</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="QRLS.html#sec13">双对角化</a>
  </dt>
  <dt>
    <a href="QRLS.html#sec14">秩亏损的LS问题</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="QRLS.html#sec15">完全正交分解,SVD与<img src="latex/latex2png-QRLS_28810176_-3.gif" alt="$x_{\text{LS}}$" class="latex-inline" style="vertical-align: -3px" width="23" height="11"></a>
      </dt>
      <dt>
	<a href="QRLS.html#sec16">选主列的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解与基本解</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="QRLS.html#sec17">欠定方程组的LS解</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="QRLS.html#sec18">广义逆</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec19"><img src="latex/latex2png-QRLS_152531986_-1.gif" alt="$LU$" class="latex-inline" style="vertical-align: -1px" width="24" height="13">分解</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec20">正交分解法</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec21">消去法</a>
      </dt>
      <dt>
	<a href="QRLS.html#sec22">消去与投影法</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="QRLS.html#sec23">秩亏损情形</a>
  </dt>
  <dt>
    <a href="QRLS.html#sec24">广义最小二乘问题</a>
  </dt>
</dl>
</div>

<p>本章主要讨论超定方程组与不定方程组的最小二乘解,即<img src="latex/latex2png-QRLS_71096098_-5.gif" alt="$\|Ax-b\|_2$" class="latex-inline" style="vertical-align: -5px" width="71" height="18">的最小化,其中<img src="latex/latex2png-QRLS_205785046_-1.gif" alt="$A\in \mathbb{R}^{n\times n}$" class="latex-inline" style="vertical-align: -1px" width="71" height="13">.解此问题的可靠方法是通过正交变换将<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">约化为各种典型形式.我们在以下的讨论中主要考虑实矩阵.但容易看出,复矩阵的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解完全可以仿照实矩阵进行.</p>

<h2><a name="sec1" id="sec1"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Householder反射</h2>

<p class="first">通过正交变换将矩阵约化为典型形式 (如Hessenberg形式)的典型方法是通过一系列正交变换,逐个地将矩阵列向量的某些指定分量化为<img src="latex/latex2png-QRLS_41055250_-1.gif" alt="$0$" class="latex-inline" style="vertical-align: -1px" width="8" height="12">.下面我们就先讨论这一过程的两种实现:Householder反射与Jacobi-Givens旋转.</p>

<p>Householder反射的几何意义是取向量<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">关于指定超平面<img src="latex/latex2png-QRLS_40665606_-5.gif" alt="$S\equiv\mathrm{span}\{v\},\quad v\neq 0$" class="latex-inline" style="vertical-align: -5px" width="154" height="18">的反射.<img src="latex/latex2png-QRLS_52820133_-5.gif" alt="$v^Tx/||v||$" class="latex-inline" style="vertical-align: -5px" width="63" height="19">为向量<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">关于平面<img src="latex/latex2png-QRLS_43349010_-1.gif" alt="$S$" class="latex-inline" style="vertical-align: -1px" width="10" height="13">的法线的投影,从而<img src="latex/latex2png-QRLS_58662601_-9.gif" alt="$x-2\frac{v^Tx}{||v||^2}v=x-2\frac{vv^T}{v^Tv}x$" class="latex-inline" style="vertical-align: -9px" width="177" height="27">为<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">关于该平面的投影.因此,设<img src="latex/latex2png-QRLS_110933904_-1.gif" alt="$v\in \mathbb{R}^n$" class="latex-inline" style="vertical-align: -1px" width="49" height="13">是非零向量,称形如<img src="latex/latex2png-QRLS_239225964_-6.gif" alt="$P=I-\frac{2}{v^Tv}vv^T$" class="latex-inline" style="vertical-align: -6px" width="119" height="21">的<img src="latex/latex2png-QRLS_2849685_0.gif" alt="$n\times n$" class="latex-inline" style="vertical-align: 0px" width="40" height="9">矩阵<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$P$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">为Householder反射.如果用<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$P$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">去乘向量<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">,则得到<img src="latex/latex2png-QRLS_156398610_0.gif" alt="$Px$" class="latex-inline" style="vertical-align: 0px" width="22" height="12">是<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">关于超平面<img src="latex/latex2png-QRLS_243698847_-5.gif" alt="$\mathrm{span}\{v\}^{\bot}$" class="latex-inline" style="vertical-align: -5px" width="68" height="19">的反射.</p>

<p>利用Householder反射可将一个向量的某些选定分量变为<img src="latex/latex2png-QRLS_41055250_-1.gif" alt="$0$" class="latex-inline" style="vertical-align: -1px" width="8" height="12">.设给定<img src="latex/latex2png-QRLS_10408550_-4.gif" alt="$0\neq x\in \mathbb{R}^n$" class="latex-inline" style="vertical-align: -4px" width="80" height="16">,欲使<img src="latex/latex2png-QRLS_156398610_0.gif" alt="$Px$" class="latex-inline" style="vertical-align: 0px" width="22" height="12">沿<img src="latex/latex2png-QRLS_52655124_-2.gif" alt="$e_1$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">的方向.由几何直观容易知道
<img src="latex/latex2png-QRLS_97659907_.gif" alt="
\begin{equation*}
  v=x\pm \|x\|_2e_1 \Longrightarrow Px= \left(I-\frac{2vv^T}{v^Tv}\right)x=\mp \|x\|_2e_1.
\end{equation*}
" class="latex-display" width="580" height="41">
有一些细节需要注意:</p>

<ol>
<li>由于<img src="latex/latex2png-QRLS_161081338_-5.gif" alt="$v_1=x-\|x\|_2e_1$" class="latex-inline" style="vertical-align: -5px" width="115" height="18">使得<img src="latex/latex2png-QRLS_156398610_0.gif" alt="$Px$" class="latex-inline" style="vertical-align: 0px" width="22" height="12">是<img src="latex/latex2png-QRLS_52655124_-2.gif" alt="$e_1$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">的正倍数,故常常采用.但当<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">接近<img src="latex/latex2png-QRLS_52655124_-2.gif" alt="$e_1$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">的一个正倍数时,则会出现严重的相消.由<img src="latex/latex2png-QRLS_125208867_-9.gif" alt="$v_1=x_1-\|x\|_2=\frac{x_1^2-\|x\|_2^2}{x_1+\|x\|_2}=\frac{- (x_2^2+\cdots +x_n^2)}{x_1+\|x\|_2}$" class="latex-inline" style="vertical-align: -9px" width="294" height="28">在<img src="latex/latex2png-QRLS_85096104_-2.gif" alt="$x_1>0$" class="latex-inline" style="vertical-align: -2px" width="47" height="13">的情况下则可避免相消.</li>
<li>实际中常常将Householder向量规范化使得<img src="latex/latex2png-QRLS_50094819_-5.gif" alt="$v(1)=1$" class="latex-inline" style="vertical-align: -5px" width="59" height="18">,这就允许将<img src="latex/latex2png-QRLS_24404707_-5.gif" alt="$v(2:n)$" class="latex-inline" style="vertical-align: -5px" width="52" height="18">存储到<img src="latex/latex2png-QRLS_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">已化零的位置,即<img src="latex/latex2png-QRLS_24404675_-5.gif" alt="$x(2:n)$" class="latex-inline" style="vertical-align: -5px" width="53" height="18">,而无需增加额外的存储开销.在这种情况下,我们将<img src="latex/latex2png-QRLS_24404707_-5.gif" alt="$v(2:n)$" class="latex-inline" style="vertical-align: -5px" width="52" height="18">称为Householder向量的基本部分.</li>
<li>在进行Householder矩阵与向量的乘法运算时,我们并不直接采用矩阵-向量乘法,而是采用<img src="latex/latex2png-QRLS_255771364_-5.gif" alt="$Px=x-2v(v^Tx)/(v^Tv)$" class="latex-inline" style="vertical-align: -5px" width="180" height="19">的运算顺序,可以显著减少运算量.</li>
<li>在基于Householder反射的矩阵分解算法中,常用到形如<img src="latex/latex2png-QRLS_143520390_-4.gif" alt="$Q=Q_1Q_2\cdots Q_r$" class="latex-inline" style="vertical-align: -4px" width="119" height="16">,<img src="latex/latex2png-QRLS_114749131_-5.gif" alt="$Q_j=I-\beta_jv^{(j)}v^{(j)T}$" class="latex-inline" style="vertical-align: -5px" width="148" height="20">的若干个Householder矩阵的乘积,其中<img src="latex/latex2png-QRLS_109518021_-30.gif" alt="$v^{(j)}=\left(\underbrace{0,\cdots,0 }_{j-1\text{个}},1,v_{j+1}^{(j)},\cdots,v_n^{(j)}\right)^T$" class="latex-inline" style="vertical-align: -30px" width="264" height="73">.通常我们并不显式地求出<img src="latex/latex2png-QRLS_43217938_-4.gif" alt="$Q$" class="latex-inline" style="vertical-align: -4px" width="11" height="16">,而是将其保持因子形式,逐个作用到给定矩阵上去,在不需显式求出变换矩阵时可显著减少运算量.</li>
<li>若要将<img src="latex/latex2png-QRLS_43217938_-4.gif" alt="$Q$" class="latex-inline" style="vertical-align: -4px" width="11" height="16">显式求出(或部分求出),则采用向后累积的形式,即先将<img src="latex/latex2png-QRLS_43217938_-4.gif" alt="$Q$" class="latex-inline" style="vertical-align: -4px" width="11" height="16">赋值为单位矩阵,依次计算<img src="latex/latex2png-QRLS_92902510_-5.gif" alt="$Q\leftarrow Q_jQ, j=r,r-1,\cdots,1$" class="latex-inline" style="vertical-align: -5px" width="206" height="17">.这样可以减少运算所需的flop数.</li>
</ol>


<h2><a name="sec2" id="sec2"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Jacobi-Givens旋转</h2>

<p class="first">Jacobi-Givens旋转是指在特定二维坐标坐标平面内进行的旋转,其一般形式为
<img src="latex/latex2png-QRLS_195576776_.gif" alt="
\begin{equation*}
  G (i,k,\theta)=
  \begin{pmatrix}
    1& \\
     & \ddots& \\
     &       & c& \cdots& s& \\
     &       & \vdots& \ddots&\vdots& \\
     & & -s&\cdots&c&\\
     & & & & &\ddots&\\
     & & & & & &1
  \end{pmatrix}.
\end{equation*}
" class="latex-display" width="580" height="199">其中<img src="latex/latex2png-QRLS_184863414_0.gif" alt="$c=\cos\theta$" class="latex-inline" style="vertical-align: 0px" width="62" height="12">,<img src="latex/latex2png-QRLS_183840693_0.gif" alt="$s=\sin\theta$" class="latex-inline" style="vertical-align: 0px" width="60" height="12">,<img src="latex/latex2png-QRLS_41776146_0.gif" alt="$c$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">和<img src="latex/latex2png-QRLS_42824722_0.gif" alt="$s$" class="latex-inline" style="vertical-align: 0px" width="6" height="8">等分别位于第<img src="latex/latex2png-QRLS_137524242_0.gif" alt="$i $" class="latex-inline" style="vertical-align: 0px" width="5" height="12">行和第<img src="latex/latex2png-QRLS_139621394_0.gif" alt="$k $" class="latex-inline" style="vertical-align: 0px" width="9" height="12">行.</p>

<p>用<img src="latex/latex2png-QRLS_75500277_-5.gif" alt="$G (i,j,\theta)^T$" class="latex-inline" style="vertical-align: -5px" width="70" height="19">左乘即产生在<img src="latex/latex2png-QRLS_5994110_-5.gif" alt="$(i,k)$" class="latex-inline" style="vertical-align: -5px" width="33" height="18">坐标平面的<img src="latex/latex2png-QRLS_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">角的旋转.运用Givens旋转可有选择地消去一些矩阵元素.</p>

<p>若<img src="latex/latex2png-QRLS_70390374_-1.gif" alt="$x\in\mathbb{R}^n$" class="latex-inline" style="vertical-align: -1px" width="50" height="13">,<img src="latex/latex2png-QRLS_245959413_-5.gif" alt="$y=G (i,k,\theta)^T$" class="latex-inline" style="vertical-align: -5px" width="104" height="19">,则
<img src="latex/latex2png-QRLS_13439106_.gif" alt="
\begin{equation*}
  y_j=
  \begin{cases}
    cx_i-sx_k& j=i,\\
    sx_i+cx_k& j=k,\\
    x_j& j\neq i,k.
  \end{cases}
\end{equation*}
" class="latex-display" width="580" height="90">若令
<img src="latex/latex2png-QRLS_214736961_.gif" alt="
\begin{align*}
  c=\frac{x_i}{\sqrt{x_i^2+x_k^2}},\\
  s=-\frac{x_k}{\sqrt{x_i^2+x_k^2}},
\end{align*}
" class="latex-display" width="580" height="83">则可将<img src="latex/latex2png-QRLS_147491820_-4.gif" alt="$y_k$" class="latex-inline" style="vertical-align: -4px" width="15" height="12">化为<img src="latex/latex2png-QRLS_41055250_-1.gif" alt="$0$" class="latex-inline" style="vertical-align: -1px" width="8" height="12">.通过合理运算顺序安排,可以避免计算中溢出发生.本算法共需<img src="latex/latex2png-QRLS_41382930_-1.gif" alt="$5$" class="latex-inline" style="vertical-align: -1px" width="8" height="12">个flop和<img src="latex/latex2png-QRLS_41120786_0.gif" alt="$1$" class="latex-inline" style="vertical-align: 0px" width="6" height="11">次平方根运算.</p>

<p>在应用Givens旋转时,同样有一些细节问题需要特别注意:</p>

<ol>
<li>当用Givens矩阵进行左乘或右乘修正时,应注意到它只影响矩阵的两行或两列.</li>
<li>同Householder变换类似,多个Givens矩阵的乘积通常并不显式地出现.</li>
<li>可将每一个旋转变换对应于一个浮点数<img src="latex/latex2png-QRLS_239694908_-4.gif" alt="$\rho$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">,从而将其存储在向量已消元的位置,通常在正弦较小时存储<img src="latex/latex2png-QRLS_233698522_-5.gif" alt="$\mathrm{sgn}(c) s/2$" class="latex-inline" style="vertical-align: -5px" width="67" height="18">,余弦较小时存储<img src="latex/latex2png-QRLS_152465907_-5.gif" alt="$\mathrm{sign} (s) 2/c$" class="latex-inline" style="vertical-align: -5px" width="72" height="18">.可以由<img src="latex/latex2png-QRLS_239694908_-4.gif" alt="$\rho$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">重新构造Givens矩阵.</li>
</ol>

<p>除标准Givens变换外,还有所谓快速Givens变换,又称&quot;免平方根 (square root-free) Givens变换&quot;.将在应用时介绍.</p>


<h2><a name="sec3" id="sec3"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a><img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解</h2>

<p class="first">一个<img src="latex/latex2png-QRLS_2915221_0.gif" alt="$m\times n$" class="latex-inline" style="vertical-align: 0px" width="45" height="9">矩阵<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解为<img src="latex/latex2png-QRLS_228297670_-4.gif" alt="$A=QR$" class="latex-inline" style="vertical-align: -4px" width="61" height="16">,其中<img src="latex/latex2png-QRLS_60553258_-4.gif" alt="$Q\in \mathbb{R}^{m\times m}$" class="latex-inline" style="vertical-align: -4px" width="78" height="16">是正交矩阵,<img src="latex/latex2png-QRLS_79427626_-1.gif" alt="$R\in \mathbb{R}^{n\times n}$" class="latex-inline" style="vertical-align: -1px" width="71" height="13">是上三角矩阵.本节将讨论<img src="latex/latex2png-QRLS_25537608_-3.gif" alt="$m\geqslant n$" class="latex-inline" style="vertical-align: -3px" width="47" height="14">且<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">为列满秩情形下的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解,主要工具为Householder变换,Givens变换以及Gram-Schmidt正交化方法.</p>

<h3><a name="sec4" id="sec4"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Householder <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解</h3>

<p class="first">利用Householder变换进行<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解是直截了当的,可给出算法描述如下:</p>

<div class="algorithm">
<span class="theorem-header">算法1<a name=""></a></span><span class="theorem-name">(Householder QR分解)</span>
给定<img src="latex/latex2png-QRLS_207882198_-1.gif" alt="$A\in \mathbb{R}^{m\times m}$" class="latex-inline" style="vertical-align: -1px" width="79" height="13">,<img src="latex/latex2png-QRLS_25537608_-3.gif" alt="$m\geqslant n$" class="latex-inline" style="vertical-align: -3px" width="47" height="14">.在算法的第<img src="latex/latex2png-QRLS_138572818_-4.gif" alt="$j $" class="latex-inline" style="vertical-align: -4px" width="8" height="16">步,我们计算Householder矩阵<img src="latex/latex2png-QRLS_238318612_-5.gif" alt="$H_j$" class="latex-inline" style="vertical-align: -5px" width="20" height="17">满足:左乘<img src="latex/latex2png-QRLS_182454821_-7.gif" alt="$A\leftarrow H_j^TA$" class="latex-inline" style="vertical-align: -7px" width="76" height="21">使<img src="latex/latex2png-QRLS_143114848_-5.gif" alt="$A(j+1:m,j)$" class="latex-inline" style="vertical-align: -5px" width="104" height="18">部分化为<img src="latex/latex2png-QRLS_41055250_-1.gif" alt="$0$" class="latex-inline" style="vertical-align: -1px" width="8" height="12">.如果<img src="latex/latex2png-QRLS_180742851_-4.gif" alt="$Q=H_1\cdots H_n$" class="latex-inline" style="vertical-align: -4px" width="102" height="16">,则<img src="latex/latex2png-QRLS_86285701_-4.gif" alt="$Q^TA=R$" class="latex-inline" style="vertical-align: -4px" width="70" height="18">是上三角阵.特别地,<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">的上三角部分被<img src="latex/latex2png-QRLS_155350034_-1.gif" alt="$R $" class="latex-inline" style="vertical-align: -1px" width="13" height="13">的上三角部分覆盖,第<img src="latex/latex2png-QRLS_138572818_-4.gif" alt="$j $" class="latex-inline" style="vertical-align: -4px" width="8" height="16">个Householder向量的基本部分存储于<img src="latex/latex2png-QRLS_143114848_-5.gif" alt="$A(j+1:m,j)$" class="latex-inline" style="vertical-align: -5px" width="104" height="18">,<img src="latex/latex2png-QRLS_104026522_-4.gif" alt="$\forall j<m$" class="latex-inline" style="vertical-align: -4px" width="53" height="16">.


</div>
本算法共需要<img src="latex/latex2png-QRLS_26238790_-5.gif" alt="$2n^2 (m-n/3)$" class="latex-inline" style="vertical-align: -5px" width="98" height="19">个flop.


<h3><a name="sec5" id="sec5"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Givens <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">方法</h3>

<p class="first">选择一个合适的消去的顺序,Givens <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解也是简单有效的.如通过自左而右逐列考察,每一列中通过自下而上地进行Givens变换对<img src="latex/latex2png-QRLS_143114848_-5.gif" alt="$A(j+1:m,j)$" class="latex-inline" style="vertical-align: -5px" width="104" height="18">引入零元,共需<img src="latex/latex2png-QRLS_242196667_-5.gif" alt="$3n^2 (m-n/3)$" class="latex-inline" style="vertical-align: -5px" width="98" height="19">个flop即可将<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">化为上三角形式.Givens变换矩阵累积起来即得到正交变换矩阵<img src="latex/latex2png-QRLS_43217938_-4.gif" alt="$Q$" class="latex-inline" style="vertical-align: -4px" width="11" height="16">.我们也可以将<img src="latex/latex2png-QRLS_14382717_-5.gif" alt="$(c,s)$" class="latex-inline" style="vertical-align: -5px" width="33" height="18">用单个浮点数<img src="latex/latex2png-QRLS_239694908_-4.gif" alt="$\rho$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">表示,从而将其存储在已化零的<img src="latex/latex2png-QRLS_4955214_-5.gif" alt="$A(i,j)$" class="latex-inline" style="vertical-align: -5px" width="45" height="18">中.</p>

<p>下面讨论快速Givens <img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">方法.</p>

<p>快速Givens方法思想就是当<img src="latex/latex2png-QRLS_43217938_-4.gif" alt="$Q$" class="latex-inline" style="vertical-align: -4px" width="11" height="16">是一系列Givens旋转的乘积时巧妙地表达它.具体地说,<img src="latex/latex2png-QRLS_154301458_-4.gif" alt="$Q $" class="latex-inline" style="vertical-align: -4px" width="11" height="16">用一个矩阵对<img src="latex/latex2png-QRLS_7042687_-5.gif" alt="$(M,D)$" class="latex-inline" style="vertical-align: -5px" width="49" height="18">来表示,其中<img src="latex/latex2png-QRLS_222974272_-5.gif" alt="$M^TM=D=\mathrm{diag} (d_i)$" class="latex-inline" style="vertical-align: -5px" width="161" height="19">且<img src="latex/latex2png-QRLS_160585019_-4.gif" alt="$d_i>0,\forall{i}$" class="latex-inline" style="vertical-align: -4px" width="66" height="16">.矩阵<img src="latex/latex2png-QRLS_154301458_-4.gif" alt="$Q $" class="latex-inline" style="vertical-align: -4px" width="11" height="16">,<img src="latex/latex2png-QRLS_150107154_0.gif" alt="$M $" class="latex-inline" style="vertical-align: 0px" width="18" height="12">和<img src="latex/latex2png-QRLS_140669970_0.gif" alt="$D $" class="latex-inline" style="vertical-align: 0px" width="13" height="12">通过公式<img src="latex/latex2png-QRLS_140961932_-4.gif" alt="$Q=MD^{-1/2}$" class="latex-inline" style="vertical-align: -4px" width="96" height="19">联系起来.易知<img src="latex/latex2png-QRLS_154301458_-4.gif" alt="$Q $" class="latex-inline" style="vertical-align: -4px" width="11" height="16">是正交的.若<img src="latex/latex2png-QRLS_142767122_0.gif" alt="$F $" class="latex-inline" style="vertical-align: 0px" width="12" height="12">使<img src="latex/latex2png-QRLS_58502416_-2.gif" alt="$F^TDF\equiv D_{\text{new}}$" class="latex-inline" style="vertical-align: -2px" width="109" height="16">是对角阵,则取<img src="latex/latex2png-QRLS_104636564_-2.gif" alt="$M_{\text{new}}=MF$" class="latex-inline" style="vertical-align: -2px" width="92" height="14">满足<img src="latex/latex2png-QRLS_207574918_-4.gif" alt="$M_{\text{new}}^TM_{\text{new}}=D_{\text{new}}$" class="latex-inline" style="vertical-align: -4px" width="137" height="18">.从而由快速Givens的表示形式<img src="latex/latex2png-QRLS_7042687_-5.gif" alt="$(M,D)$" class="latex-inline" style="vertical-align: -5px" width="49" height="18">做变换即可得到<img src="latex/latex2png-QRLS_263367508_-5.gif" alt="$(M_{\text{new}},D_{\text{new}})$" class="latex-inline" style="vertical-align: -5px" width="95" height="18">.</p>

<p>以<img src="latex/latex2png-QRLS_41186322_0.gif" alt="$2$" class="latex-inline" style="vertical-align: 0px" width="8" height="11">维的情形来说明以上思想.令<img src="latex/latex2png-QRLS_57090381_-5.gif" alt="$x= (x_1,x_2)^T$" class="latex-inline" style="vertical-align: -5px" width="95" height="19">,给定<img src="latex/latex2png-QRLS_261544673_-5.gif" alt="$D=\mathrm{diag} (d_1,d_2),(d_1,d_2>0)$" class="latex-inline" style="vertical-align: -5px" width="208" height="18">.定义<img src="latex/latex2png-QRLS_103253036_-7.gif" alt="$F_1=\left[\begin{smallmatrix}\beta_1& 1\\1& \alpha_1\end{smallmatrix}\right]$" class="latex-inline" style="vertical-align: -7px" width="90" height="22">,则
<img src="latex/latex2png-QRLS_191441546_.gif" alt="
\begin{align*}
F_1^Tx&=\begin{bmatrix}
\beta_1x_1+x_2\\
x_1+\alpha_1x_2
\end{bmatrix},\\
F_1^TDF_1&=
\begin{bmatrix}
  d_2+\beta_1^2d_1& d_1\beta_1+d_2\alpha_1\\
  d_1\beta_1+d_2\alpha_1& d_1+\alpha_1^2d_2
\end{bmatrix}
\equiv D_1.
\end{align*}
" class="latex-display" width="580" height="109">若<img src="latex/latex2png-QRLS_37184484_-4.gif" alt="$x_2\neq 0$" class="latex-inline" style="vertical-align: -4px" width="47" height="16">,取<img src="latex/latex2png-QRLS_82545926_-5.gif" alt="$\alpha_1=-x_1/x_2$" class="latex-inline" style="vertical-align: -5px" width="93" height="18">,<img src="latex/latex2png-QRLS_255531521_-5.gif" alt="$\beta_1=-\alpha_1\alpha_2/d_1$" class="latex-inline" style="vertical-align: -5px" width="111" height="18">,则
<img src="latex/latex2png-QRLS_151391424_.gif" alt="
\begin{align*}
  F_1^Tx&=
  \begin{bmatrix}
   x_2 (1+\gamma_1)\\
   0
  \end{bmatrix},\\
F_1^TDF_1&=
\begin{bmatrix}
  d_2 (1+\gamma_1)\\
 & d_1 (1+\gamma_1)
\end{bmatrix}.
\end{align*}
" class="latex-display" width="580" height="109">其中<img src="latex/latex2png-QRLS_99275996_-5.gif" alt="$\gamma_1\equiv -\alpha_1\beta_1= (d_2/d_1) (x_1/x_2)^2$" class="latex-inline" style="vertical-align: -5px" width="222" height="19">.</p>

<p>类似地,如果<img src="latex/latex2png-QRLS_37184740_-4.gif" alt="$x_1\neq 0$" class="latex-inline" style="vertical-align: -4px" width="47" height="16">,则可定义<img src="latex/latex2png-QRLS_11649967_-8.gif" alt="$F_2=\left[\begin{smallmatrix}1& \alpha_2\\ \beta_2& 1\end{smallmatrix}\right]$" class="latex-inline" style="vertical-align: -8px" width="90" height="24">,其中<img src="latex/latex2png-QRLS_50243787_-5.gif" alt="$\alpha_2\equiv -x_2/x_1,\beta_2 \equiv - (d_1/d_2)\alpha_2$" class="latex-inline" style="vertical-align: -5px" width="225" height="18">.则
<img src="latex/latex2png-QRLS_14544238_.gif" alt="
\begin{align*}
  F_2^Tx&=
  \begin{bmatrix}
    x_1 (1+\gamma_2)\\
    0
  \end{bmatrix},\\
F_2^TDF_2&=
\begin{bmatrix}
  d_1(1+\gamma_2)\\
  & d_2 (1+\gamma_2)
\end{bmatrix}.
\end{align*}
" class="latex-display" width="580" height="109">其中<img src="latex/latex2png-QRLS_171669440_-5.gif" alt="$\gamma_2=-\alpha_2\beta_2= (d_1/d_2) (x_2/x_1)^2$" class="latex-inline" style="vertical-align: -5px" width="222" height="19">.</p>

<p>这样,我们就完成了对该算法思想的描述.实际中选择变化类型使矩阵元素的&quot;增长因子&quot;<img src="latex/latex2png-QRLS_122397137_-5.gif" alt="$(1+\gamma_i)$" class="latex-inline" style="vertical-align: -5px" width="53" height="18">以<img src="latex/latex2png-QRLS_41186322_0.gif" alt="$2$" class="latex-inline" style="vertical-align: 0px" width="8" height="11">为界.</p>

<p>借助快速Givens变换,我们可以计算非奇异的<img src="latex/latex2png-QRLS_171520472_-1.gif" alt="$M\in\mathbb{R}^{m\times m}$" class="latex-inline" style="vertical-align: -1px" width="84" height="13">和正的<img src="latex/latex2png-QRLS_242981885_-5.gif" alt="$d(1:m)$" class="latex-inline" style="vertical-align: -5px" width="57" height="18">使得<img src="latex/latex2png-QRLS_86416709_0.gif" alt="$M^TA=T$" class="latex-inline" style="vertical-align: 0px" width="75" height="14">为上三角阵,且<img src="latex/latex2png-QRLS_191279398_-5.gif" alt="$M^TM=\mathrm{diag} (d_1,\cdots,d_m)$" class="latex-inline" style="vertical-align: -5px" width="188" height="19">.则<img src="latex/latex2png-QRLS_216342627_-5.gif" alt="$A= (MD^{-1/2}) (D^{1/2}T)$" class="latex-inline" style="vertical-align: -5px" width="169" height="20">是<img src="latex/latex2png-QRLS_42169362_0.gif" alt="$A$" class="latex-inline" style="vertical-align: 0px" width="12" height="12">的<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解.这种算法需要<img src="latex/latex2png-QRLS_26238790_-5.gif" alt="$2n^2 (m-n/3)$" class="latex-inline" style="vertical-align: -5px" width="98" height="19">个flop,且不涉及平方根运算.</p>

<p>Givens方法对于稀疏矩阵问题,尤其是带状矩阵问题有特别的优势,例如对Hessenberg矩阵进行<img src="latex/latex2png-QRLS_157578258_-4.gif" alt="$QR$" class="latex-inline" style="vertical-align: -4px" width="25" height="16">分解只需要<img src="latex/latex2png-QRLS_65768391_-1.gif" alt="$3n^2$" class="latex-inline" style="vertical-align: -1px" width="24" height="15">个flop.</p>


<h3><a name="sec6" id="sec6"></a>
<a href="QRLS.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Gram-Schmidt方法</h3>

<p class="first">经典Gram-Schmidt方法(CGS)是我们熟.gif" alt="$M^TA=T$" class="latex-inline" style="vertical-align: 0px" width="75" height="14">涓轰